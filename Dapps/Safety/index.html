



<!DOCTYPE html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="以太坊中文文档">
      
      
      
        <meta name="author" content="Nosy">
      
      
        <meta name="lang:clipboard.copy" content="复制">
      
        <meta name="lang:clipboard.copied" content="已复制">
      
        <meta name="lang:search.language" content="zh">
      
        <meta name="lang:search.result.none" content="没有找到符合条件的结果">
      
        <meta name="lang:search.result.one" content="找到 1 个符合条件的结果">
      
        <meta name="lang:search.result.other" content="# 个符合条件的结果">
      
        <meta name="lang:search.tokenizer" content="[\uff0c\u3002]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.2, mkdocs-material-2.2.5">
    
    
      
        <title>安全技术 - 以太坊文档</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.bcabdff3.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.792431c1.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    
      <body data-md-color-primary="indigo" data-md-color-accent="indigo">
    
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="以太坊文档" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                以太坊文档
              </span>
              <span class="md-header-nav__topic">
                安全技术
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" required placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset">&#xE5CD;</button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            键入以开始搜索
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/wohugb/ethereum-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/ethereum-docs
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

  

<nav class="md-tabs md-tabs--active" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href="../.." title="前言" class="md-tabs__link">
        前言
      </a>
    
  </li>

      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Basics/introduction/" title="基础" class="md-tabs__link">
          基础
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../White-Paper/" title="白皮书" class="md-tabs__link">
          白皮书
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Clients/" title="客户端" class="md-tabs__link">
          客户端
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="./" title="ÐApp开发" class="md-tabs__link md-tabs__link--active">
          ÐApp开发
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Infrastructure/Chain-Spec-Format/" title="基础设施" class="md-tabs__link">
          基础设施
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Research/Proof-of-Stake-FAQ/" title="研究" class="md-tabs__link">
          研究
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../D3VTechnologies/RLP/" title="ÐΞV技术" class="md-tabs__link">
          ÐΞV技术
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Technologies/Patricia-Tree/" title="以太坊技术" class="md-tabs__link">
          以太坊技术
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../EthashDashimoto/" title="挖矿算法" class="md-tabs__link">
          挖矿算法
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Whisper/" title="私语" class="md-tabs__link">
          私语
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../../Misc/Problems/" title="杂项" class="md-tabs__link">
          杂项
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </span>
    以太坊文档
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/wohugb/ethereum-docs" title="前往 Github 仓库" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      wohugb/ethereum-docs
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="前言" class="md-nav__link">
      前言
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../home/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      基础
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        基础
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/introduction/" title="介绍" class="md-nav__link">
      介绍
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/Getting-Ether/" title="获取以太币" class="md-nav__link">
      获取以太币
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/dapps/" title="无心应用" class="md-nav__link">
      无心应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/Design-Rationale/" title="设计原理" class="md-nav__link">
      设计原理
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Yellow-Paper/" title="黄皮书" class="md-nav__link">
      黄皮书
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/FAQ/" title="FAQ" class="md-nav__link">
      FAQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/Releases/" title="发布" class="md-nav__link">
      发布
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Basics/Wishlist/" title="愿望清单" class="md-nav__link">
      愿望清单
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      白皮书
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        白皮书
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/history/" title="历史" class="md-nav__link">
      历史
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/Ethereum/" title="以太坊" class="md-nav__link">
      以太坊
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/Applications/" title="应用" class="md-nav__link">
      应用
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/Miscellanea-And-Concerns/" title="杂项" class="md-nav__link">
      杂项
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/Conclusion/" title="结论" class="md-nav__link">
      结论
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../White-Paper/Notes-and-Further-Reading/" title="更多" class="md-nav__link">
      更多
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      客户端
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        客户端
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/go-ethereum/" title="Geth (Go)" class="md-nav__link">
      Geth (Go)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/parity/" title="Parity (Rust)" class="md-nav__link">
      Parity (Rust)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/pyethapp/" title="pyethapp (Python)" class="md-nav__link">
      pyethapp (Python)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/cpp-ethereum/" title="cpp-ethereum (C++)" class="md-nav__link">
      cpp-ethereum (C++)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Clients/ethereumj/" title="ethereumj (Java)" class="md-nav__link">
      ethereumj (Java)
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6" checked>
    
    <label class="md-nav__link" for="nav-6">
      ÐApp开发
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        ÐApp开发
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        安全技术
      </label>
    
    <a href="./" title="安全技术" class="md-nav__link md-nav__link--active">
      安全技术
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional-requested-content" title="Additional Requested Content" class="md-nav__link">
    Additional Requested Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-philosophy" title="General Philosophy" class="md-nav__link">
    General Philosophy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-notifications" title="Security Notifications" class="md-nav__link">
    Security Notifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations-for-smart-contract-security-in-solidity" title="Recommendations for Smart Contract Security in Solidity" class="md-nav__link">
    Recommendations for Smart Contract Security in Solidity
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-calls" title="External Calls" class="md-nav__link">
    External Calls
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoid-external-calls-when-possible" title="Avoid external calls when possible" class="md-nav__link">
    Avoid external calls when possible
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-send-avoid-callvalue" title="Use send(), avoid call.value()" class="md-nav__link">
    Use send(), avoid call.value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-external-calls" title="Handle errors in external calls" class="md-nav__link">
    Handle errors in external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-make-control-flow-assumptions-after-external-calls" title="Don't make control flow assumptions after external calls" class="md-nav__link">
    Don't make control flow assumptions after external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#favor-pull-over-push-for-external-calls" title="Favor pull over push for external calls" class="md-nav__link">
    Favor pull over push for external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mark-untrusted-contracts" title="Mark untrusted contracts" class="md-nav__link">
    Mark untrusted contracts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beware-rounding-with-integer-division" title="Beware rounding with integer division" class="md-nav__link">
    Beware rounding with integer division
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remember-that-on-chain-data-is-public" title="Remember that on-chain data is public" class="md-nav__link">
    Remember that on-chain data is public
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-2-party-or-n-party-contracts-beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return" title="In 2-party or N-party contracts, beware of the possibility that some participants may "drop offline" and not return" class="md-nav__link">
    In 2-party or N-party contracts, beware of the possibility that some participants may "drop offline" and not return
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keep-fallback-functions-simple" title="Keep fallback functions simple" class="md-nav__link">
    Keep fallback functions simple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#explicitly-mark-visibility-in-functions-and-state-variables" title="Explicitly mark visibility in functions and state variables" class="md-nav__link">
    Explicitly mark visibility in functions and state variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beware-division-by-zero" title="Beware division by zero" class="md-nav__link">
    Beware division by zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiate-functions-and-events" title="Differentiate functions and events" class="md-nav__link">
    Differentiate functions and events
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-attacks" title="Known Attacks" class="md-nav__link">
    Known Attacks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#call-depth-attack-deprecated" title="Call Depth Attack (Deprecated)" class="md-nav__link">
    Call Depth Attack (Deprecated)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#race-conditions42" title="Race Conditions*" class="md-nav__link">
    Race Conditions*
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reentrancy" title="Reentrancy" class="md-nav__link">
    Reentrancy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-function-race-conditions" title="Cross-function Race Conditions" class="md-nav__link">
    Cross-function Race Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfalls-in-race-condition-solutions" title="Pitfalls in Race Condition Solutions" class="md-nav__link">
    Pitfalls in Race Condition Solutions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-with-unexpected-throw" title="DoS with (Unexpected) Throw" class="md-nav__link">
    DoS with (Unexpected) Throw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-with-block-gas-limit" title="DoS with Block Gas Limit" class="md-nav__link">
    DoS with Block Gas Limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp-dependence" title="Timestamp Dependence" class="md-nav__link">
    Timestamp Dependence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-ordering-dependence-tod" title="Transaction-Ordering Dependence (TOD)" class="md-nav__link">
    Transaction-Ordering Dependence (TOD)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-engineering-techniques" title="Software Engineering Techniques" class="md-nav__link">
    Software Engineering Techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrading-broken-contracts" title="Upgrading Broken Contracts" class="md-nav__link">
    Upgrading Broken Contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circuit-breakers-pause-contract-functionality" title="Circuit Breakers (Pause contract functionality)" class="md-nav__link">
    Circuit Breakers (Pause contract functionality)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#speed-bumps-delay-contract-actions" title="Speed Bumps (Delay contract actions)" class="md-nav__link">
    Speed Bumps (Delay contract actions)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" title="Rate Limiting" class="md-nav__link">
    Rate Limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assert-guards" title="Assert Guards" class="md-nav__link">
    Assert Guards
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contract-rollout" title="Contract Rollout" class="md-nav__link">
    Contract Rollout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-deprecation" title="Automatic Deprecation" class="md-nav__link">
    Automatic Deprecation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-amount-of-ether-per-usercontract" title="Restrict amount of Ether per user/contract" class="md-nav__link">
    Restrict amount of Ether per user/contract
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-related-documentation-and-procedures" title="Security-related Documentation and Procedures" class="md-nav__link">
    Security-related Documentation and Procedures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-tools" title="Security Tools" class="md-nav__link">
    Security Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-improvements" title="Future improvements" class="md-nav__link">
    Future improvements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smart-contract-security-bibliography" title="Smart Contract Security Bibliography" class="md-nav__link">
    Smart Contract Security Bibliography
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#by-ethereum-core-developers" title="By Ethereum core developers" class="md-nav__link">
    By Ethereum core developers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#by-community" title="By Community" class="md-nav__link">
    By Community
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attribution" title="Attribution" class="md-nav__link">
    Attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" title="License" class="md-nav__link">
    License
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Resources/" title="开发资源" class="md-nav__link">
      开发资源
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../JavaScript-API/" title="JS API" class="md-nav__link">
      JS API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../JSON-RPC/" title="JSON RPC API" class="md-nav__link">
      JSON RPC API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solidity/" title="Solidity" class="md-nav__link">
      Solidity
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidity-Features/" title="Solidity 特色" class="md-nav__link">
      Solidity 特色
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Solidity-Collections/" title="Solidity 合集" class="md-nav__link">
      Solidity 合集
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../solidity-cheatsheet/" title="Solidity 备忘单" class="md-nav__link">
      Solidity 备忘单
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Useful-Ðapp-Patterns/" title="有用的Ðapp模式" class="md-nav__link">
      有用的Ðapp模式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Standardized_Contract_APIs/" title="标准化合约接口" class="md-nav__link">
      标准化合约接口
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Using-Meteor/" title="使用Meteor" class="md-nav__link">
      使用Meteor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Tutorial/" title="开发指南" class="md-nav__link">
      开发指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mix-IDE/" title="Mix 指南" class="md-nav__link">
      Mix 指南
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Mix-Features/" title="Mix 特色" class="md-nav__link">
      Mix 特色
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../viper/" title="Viper" class="md-nav__link">
      Viper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../Serpent/" title="Serpent" class="md-nav__link">
      Serpent
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../LLL/" title="LLL" class="md-nav__link">
      LLL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mutan/" title="Mutan" class="md-nav__link">
      Mutan
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      基础设施
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        基础设施
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Chain-Spec-Format/" title="链规范格式" class="md-nav__link">
      链规范格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Inter-exchange-Client-Address-Protocol/" title="地址互换协议" class="md-nav__link">
      地址互换协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/URL-Hint-Protocol/" title="网址提示协议" class="md-nav__link">
      网址提示协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/NatSpec-Determination/" title="自然规格确认" class="md-nav__link">
      自然规格确认
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Network-Status/" title="网络状态" class="md-nav__link">
      网络状态
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Raspberry-Pi-instructions/" title="树莓派" class="md-nav__link">
      树莓派
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Exchange-Integration/" title="交易一体化" class="md-nav__link">
      交易一体化
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Mining/" title="挖矿" class="md-nav__link">
      挖矿
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Licensing/" title="许可" class="md-nav__link">
      许可
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Infrastructure/Consortium-Chain-Development/" title="联盟链开发" class="md-nav__link">
      联盟链开发
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      研究
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        研究
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Research/Proof-of-Stake-FAQ/" title="权益证明" class="md-nav__link">
      权益证明
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Research/Sharding-FAQ/" title="分片区块链" class="md-nav__link">
      分片区块链
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      ÐΞV技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        ÐΞV技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../D3VTechnologies/RLP/" title="RLP 编码" class="md-nav__link">
      RLP 编码
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../D3VTechnologies/Node-discovery-protocol/" title="节点发现协议" class="md-nav__link">
      节点发现协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../D3VTechnologies/Wire-Protocol/" title="ÐΞVp2p 有线协议" class="md-nav__link">
      ÐΞVp2p 有线协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../D3VTechnologies/libp2p-Whitepaper/" title="ÐΞVp2p 白皮书" class="md-nav__link">
      ÐΞVp2p 白皮书
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../D3VTechnologies/Web3-Secret-Storage-Definition/" title="Web3 秘密存储" class="md-nav__link">
      Web3 秘密存储
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      以太坊技术
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        以太坊技术
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Patricia-Tree/" title="词树" class="md-nav__link">
      词树
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Ethereum-Wire-Protocol/" title="有线协议" class="md-nav__link">
      有线协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Light-client-protocol/" title="轻端协议" class="md-nav__link">
      轻端协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Subtleties/" title="玄机" class="md-nav__link">
      玄机
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Solidity/" title="固语言" class="md-nav__link">
      固语言
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Ethereum-Natural-Specification-Format/" title="NatSpec格式" class="md-nav__link">
      NatSpec格式
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Ethereum-Contract-ABI/" title="合同ABI" class="md-nav__link">
      合同ABI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Bad-Block-Reporting/" title="坏块报告" class="md-nav__link">
      坏块报告
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Technologies/Bad-Chain-Canary/" title="坏链金丝雀" class="md-nav__link">
      坏链金丝雀
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      挖矿算法
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        挖矿算法
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../EthashDashimoto/" title="概述" class="md-nav__link">
      概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../EthashDashimoto/Ethash/" title="Ethash" class="md-nav__link">
      Ethash
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../EthashDashimoto/Ethash-C-API/" title="Ethash C API" class="md-nav__link">
      Ethash C API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../EthashDashimoto/Ethash-DAG/" title="Ethash DAG" class="md-nav__link">
      Ethash DAG
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      私语
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        私语
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Whisper/" title="低语提议" class="md-nav__link">
      低语提议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Whisper/Overview/" title="耳语概述" class="md-nav__link">
      耳语概述
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Whisper/Wire-Protocol/" title="PoC-1 有线协议" class="md-nav__link">
      PoC-1 有线协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Whisper/PoC-2-Wire-Protocol/" title="PoC-2 有线协议" class="md-nav__link">
      PoC-2 有线协议
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Whisper/PoC-2-Protocol-Spec/" title="PoC-2 白皮书" class="md-nav__link">
      PoC-2 白皮书
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      杂项
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        杂项
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Misc/Problems/" title="加密货币的难题" class="md-nav__link">
      加密货币的难题
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Misc/Chain-Fibers-Redux/" title="链条纤维" class="md-nav__link">
      链条纤维
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Misc/Glossary/" title="词汇表" class="md-nav__link">
      词汇表
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">目录</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#additional-requested-content" title="Additional Requested Content" class="md-nav__link">
    Additional Requested Content
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-philosophy" title="General Philosophy" class="md-nav__link">
    General Philosophy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-notifications" title="Security Notifications" class="md-nav__link">
    Security Notifications
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recommendations-for-smart-contract-security-in-solidity" title="Recommendations for Smart Contract Security in Solidity" class="md-nav__link">
    Recommendations for Smart Contract Security in Solidity
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-calls" title="External Calls" class="md-nav__link">
    External Calls
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avoid-external-calls-when-possible" title="Avoid external calls when possible" class="md-nav__link">
    Avoid external calls when possible
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#use-send-avoid-callvalue" title="Use send(), avoid call.value()" class="md-nav__link">
    Use send(), avoid call.value()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handle-errors-in-external-calls" title="Handle errors in external calls" class="md-nav__link">
    Handle errors in external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dont-make-control-flow-assumptions-after-external-calls" title="Don't make control flow assumptions after external calls" class="md-nav__link">
    Don't make control flow assumptions after external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#favor-pull-over-push-for-external-calls" title="Favor pull over push for external calls" class="md-nav__link">
    Favor pull over push for external calls
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mark-untrusted-contracts" title="Mark untrusted contracts" class="md-nav__link">
    Mark untrusted contracts
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beware-rounding-with-integer-division" title="Beware rounding with integer division" class="md-nav__link">
    Beware rounding with integer division
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remember-that-on-chain-data-is-public" title="Remember that on-chain data is public" class="md-nav__link">
    Remember that on-chain data is public
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-2-party-or-n-party-contracts-beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return" title="In 2-party or N-party contracts, beware of the possibility that some participants may "drop offline" and not return" class="md-nav__link">
    In 2-party or N-party contracts, beware of the possibility that some participants may "drop offline" and not return
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#keep-fallback-functions-simple" title="Keep fallback functions simple" class="md-nav__link">
    Keep fallback functions simple
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#explicitly-mark-visibility-in-functions-and-state-variables" title="Explicitly mark visibility in functions and state variables" class="md-nav__link">
    Explicitly mark visibility in functions and state variables
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#beware-division-by-zero" title="Beware division by zero" class="md-nav__link">
    Beware division by zero
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#differentiate-functions-and-events" title="Differentiate functions and events" class="md-nav__link">
    Differentiate functions and events
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#known-attacks" title="Known Attacks" class="md-nav__link">
    Known Attacks
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#call-depth-attack-deprecated" title="Call Depth Attack (Deprecated)" class="md-nav__link">
    Call Depth Attack (Deprecated)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#race-conditions42" title="Race Conditions*" class="md-nav__link">
    Race Conditions*
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#reentrancy" title="Reentrancy" class="md-nav__link">
    Reentrancy
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cross-function-race-conditions" title="Cross-function Race Conditions" class="md-nav__link">
    Cross-function Race Conditions
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pitfalls-in-race-condition-solutions" title="Pitfalls in Race Condition Solutions" class="md-nav__link">
    Pitfalls in Race Condition Solutions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-with-unexpected-throw" title="DoS with (Unexpected) Throw" class="md-nav__link">
    DoS with (Unexpected) Throw
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dos-with-block-gas-limit" title="DoS with Block Gas Limit" class="md-nav__link">
    DoS with Block Gas Limit
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timestamp-dependence" title="Timestamp Dependence" class="md-nav__link">
    Timestamp Dependence
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#transaction-ordering-dependence-tod" title="Transaction-Ordering Dependence (TOD)" class="md-nav__link">
    Transaction-Ordering Dependence (TOD)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-engineering-techniques" title="Software Engineering Techniques" class="md-nav__link">
    Software Engineering Techniques
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#upgrading-broken-contracts" title="Upgrading Broken Contracts" class="md-nav__link">
    Upgrading Broken Contracts
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#circuit-breakers-pause-contract-functionality" title="Circuit Breakers (Pause contract functionality)" class="md-nav__link">
    Circuit Breakers (Pause contract functionality)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#speed-bumps-delay-contract-actions" title="Speed Bumps (Delay contract actions)" class="md-nav__link">
    Speed Bumps (Delay contract actions)
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rate-limiting" title="Rate Limiting" class="md-nav__link">
    Rate Limiting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#assert-guards" title="Assert Guards" class="md-nav__link">
    Assert Guards
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contract-rollout" title="Contract Rollout" class="md-nav__link">
    Contract Rollout
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-deprecation" title="Automatic Deprecation" class="md-nav__link">
    Automatic Deprecation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restrict-amount-of-ether-per-usercontract" title="Restrict amount of Ether per user/contract" class="md-nav__link">
    Restrict amount of Ether per user/contract
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-related-documentation-and-procedures" title="Security-related Documentation and Procedures" class="md-nav__link">
    Security-related Documentation and Procedures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-tools" title="Security Tools" class="md-nav__link">
    Security Tools
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-improvements" title="Future improvements" class="md-nav__link">
    Future improvements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#smart-contract-security-bibliography" title="Smart Contract Security Bibliography" class="md-nav__link">
    Smart Contract Security Bibliography
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#by-ethereum-core-developers" title="By Ethereum core developers" class="md-nav__link">
    By Ethereum core developers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#by-community" title="By Community" class="md-nav__link">
    By Community
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#attribution" title="Attribution" class="md-nav__link">
    Attribution
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#license" title="License" class="md-nav__link">
    License
  </a>
  
</li>
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="_1">以太坊合同安全技术和技巧<a class="headerlink" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>The community is encouraged to keep this wiki updated: it becomes more complete as more contributions are added.</strong></p>
<p>Currently this wiki is out-of-date and see its source <a href="https://github.com/ConsenSys/smart-contract-best-practices">"Smart Contract Best Practices"</a> for more recent updates and corrections.</p>
<h2 id="additional-requested-content">Additional Requested Content<a class="headerlink" href="#additional-requested-content" title="Permanent link">&para;</a></h2>
<p>We especially welcome content in the following areas:</p>
<ul>
<li>Testing Solidity code (structure, frameworks, common test idioms)</li>
<li>Software engineering practices for smart contracts and/or blockchain-based programming</li>
</ul>
<h2 id="general-philosophy">General Philosophy<a class="headerlink" href="#general-philosophy" title="Permanent link">&para;</a></h2>
<p>Ethereum and complex blockchain programs are new and highly experimental. Therefore, you should expect constant changes in the security landscape, as new bugs and security risks are discovered, and new best practices are developed. Following the security practices in this document is therefore only the beginning of the security work you will need to do as a smart contract developer.</p>
<p>Smart contract programming requires a different engineering mindset than you may be used to. The cost of failure can be high, and change can be difficult, making it in some ways more similar to hardware programming or financial services programming than web or mobile development. It is therefore not enough to defend against known vulnerabilities. Instead, you will need to learn a new philosophy of development:</p>
<ul>
<li><strong>Prepare for failure</strong>. Any non-trivial contract will have errors in it. Your code must therefore be able to respond to bugs and vulnerabilities gracefully.</li>
<li>Pause the contract when things are going wrong ('circuit breaker')</li>
<li>Manage the amount of money at risk (rate limiting, maximum usage)</li>
<li>
<p>Have an effective upgrade path for bugfixes and improvements</p>
</li>
<li>
<p><strong>Roll out carefully</strong>. It is always better to catch bugs before a full production release.</p>
</li>
<li>Test contracts thoroughly, and add tests whenever new attack vectors are discovered</li>
<li>Provide bug bounties starting from alpha testnet releases</li>
<li>
<p>Rollout in phases, with increasing usage and testing in each phase</p>
</li>
<li>
<p><strong>Keep contracts simple</strong>. Complexity increases the likelihood of errors.</p>
</li>
<li>Ensure the contract logic is simple</li>
<li>Modularize code to keep contracts and functions small</li>
<li>Use already-written tools or code where possible (eg. don't roll your own random number generator)</li>
<li>Prefer clarity to performance whenever possible</li>
<li>
<p>Only use the blockchain for the parts of your system that require decentralization</p>
</li>
<li>
<p><strong>Stay up to date</strong>. Use the resources listed in the next section to keep track of new security developments.</p>
</li>
<li>Check your contracts for any new bug that's discovered</li>
<li>Upgrade to the latest version of any tool or library as soon as possible</li>
<li>
<p>Adopt new security techniques that appear useful</p>
</li>
<li>
<p><strong>Be aware of blockchain properties</strong>. While much of your programming experience will be relevant to Ethereum programming, there are some pitfalls to be aware of.</p>
</li>
<li>Be extremely careful about external contract calls, which may execute malicious code and change control flow.</li>
<li>Understand that your public functions are public, and may be called maliciously. Your private data is also viewable by anyone.</li>
<li>Keep gas costs and the block gas limit in mind.</li>
</ul>
<h2 id="security-notifications">Security Notifications<a class="headerlink" href="#security-notifications" title="Permanent link">&para;</a></h2>
<p>This is a list of resources that will often highlight discovered exploits in Ethereum or Solidity. The official source of security notifications is the Ethereum Blog, but in many cases vulnerabilities will be disclosed and discussed earlier in other locations.</p>
<ul>
<li><a href="https://blog.ethereum.org/">Ethereum Blog</a>: The official Ethereum blog</li>
<li><a href="https://blog.ethereum.org/category/security/">Ethereum Blog - Security only</a>: All blog posts that are tagged <em>Security</em></li>
<li><a href="https://gitter.im/orgs/ethereum/rooms">Ethereum Gitter</a> chat rooms</li>
<li><a href="https://gitter.im/ethereum/solidity">Solidity</a></li>
<li><a href="https://gitter.im/ethereum/go-ethereum">Go-Ethereum</a></li>
<li><a href="https://gitter.im/ethereum/cpp-ethereum">CPP-Ethereum</a></li>
<li><a href="https://gitter.im/ethereum/research">Research</a></li>
<li><a href="https://www.reddit.com/r/ethereum">Reddit</a></li>
<li><a href="https://ethstats.net/">Network Stats</a></li>
</ul>
<p>It's highly recommended that you <em>regularly</em> read all these sources, as exploits they note may impact your contracts.</p>
<p>Additionally, here is a list of Ethereum core developers who may write about security, and see the <a href="https://github.com/ConsenSys/smart-contract-best-practices#smart-contract-security-bibliography">bibliography</a> for more from the community.</p>
<ul>
<li><strong>Vitalik Buterin</strong>: <a href="https://twitter.com/vitalikbuterin">Twitter</a>, <a href="https://github.com/vbuterin">Github</a>, <a href="https://www.reddit.com/user/vbuterin">Reddit</a>, <a href="https://blog.ethereum.org/author/vitalik-buterin/">Ethereum Blog</a></li>
<li><strong>Dr. Christian Reitwiessner</strong>: <a href="https://twitter.com/ethchris">Twitter</a>, <a href="https://github.com/chriseth">Github</a>, <a href="https://blog.ethereum.org/author/christian_r/">Ethereum Blog</a></li>
<li><strong>Dr. Gavin Wood</strong>: <a href="https://twitter.com/gavofyork">Twitter</a>, <a href="http://gavwood.com/">Blog</a>, <a href="https://github.com/gavofyork">Github</a></li>
<li><strong>Vlad Zamfir</strong>: <a href="https://twitter.com/vladzamfir">Twitter</a>, <a href="https://github.com/vladzamfir">Github</a>, <a href="https://blog.ethereum.org/author/vlad/">Ethereum Blog</a></li>
</ul>
<p>Beyond following core developers, it is critical to participate in the wider blockchain-related security community - as security disclosures or observations will come through a variety of parties.</p>
<h2 id="recommendations-for-smart-contract-security-in-solidity">Recommendations for Smart Contract Security in Solidity<a class="headerlink" href="#recommendations-for-smart-contract-security-in-solidity" title="Permanent link">&para;</a></h2>
<h3 id="external-calls">External Calls<a class="headerlink" href="#external-calls" title="Permanent link">&para;</a></h3>
<h4 id="avoid-external-calls-when-possible">Avoid external calls when possible<a class="headerlink" href="#avoid-external-calls-when-possible" title="Permanent link">&para;</a></h4>
<p>Calls to untrusted contracts can introduce several unexpected risks or errors. External calls may execute malicious code in that contract <em>or</em> any other contract that it depends upon. As such, every external call should be treated as a potential security risk, and removed if possible. When it is not possible to remove external calls, use the recommendations in the rest of this section to minimize the danger.</p>
<h4 id="use-send-avoid-callvalue">Use <code>send()</code>, avoid <code>call.value()</code><a class="headerlink" href="#use-send-avoid-callvalue" title="Permanent link">&para;</a></h4>
<p>When sending Ether, use <code>someAddress.send()</code> and avoid <code>someAddress.call.value()()</code>.</p>
<p>External calls such as <code>someAddress.call.value()()</code> can trigger malicious code. While <code>send()</code> also triggers code, it is safe because it only has access to gas stipend of 2,300 gas. Currently, this is only enough to log an event, not enough to launch an attack.</p>
<div class="codehilite"><pre><span></span>// bad
if(!someAddress.call.value(100)()) {
    // Some failure code
}

// good
if(!someAddress.send(100)) {
    // Some failure code
}
</pre></div>

<h4 id="handle-errors-in-external-calls">Handle errors in external calls<a class="headerlink" href="#handle-errors-in-external-calls" title="Permanent link">&para;</a></h4>
<p>Solidity offers low-level call methods that work on raw addresses: <code>address.call()</code>, <code>address.callcode()</code>, <code>address.delegatecall()</code>, and <code>address.send</code>. These low-level methods never throw an exception, but will return <code>false</code> if the call encounters an exception. On the other hand, <em>contract calls</em> (e.g., <code>ExternalContract.doSomething()</code>) will automatically propagate a throw (for example, <code>ExternalContract.doSomething()</code> will also <code>throw</code> if <code>doSomething()</code> throws).</p>
<p>If you choose to use the low-level call methods, make sure to handle the possibility that the call will fail, by checking the return value.</p>
<div class="codehilite"><pre><span></span>// bad
someAddress.send(55);
someAddress.call.value(55)(); // this is doubly dangerous, as it will forward all remaining gas and doesn&#39;t check for result
someAddress.call.value(100)(bytes4(sha3(&quot;deposit()&quot;))); // if deposit throws an exception, the raw call() will only return false and transaction will NOT be reverted

// good
if(!someAddress.send(55)) {
    // Some failure code
}

ExternalContract(someAddress).deposit.value(100);
</pre></div>

<h4 id="dont-make-control-flow-assumptions-after-external-calls">Don't make control flow assumptions after external calls<a class="headerlink" href="#dont-make-control-flow-assumptions-after-external-calls" title="Permanent link">&para;</a></h4>
<p>Whether using <em>raw calls</em> or <em>contract calls</em>, assume that malicious code will execute if <code>ExternalContract</code> is untrusted. Even if <code>ExternalContract</code> is not malicious, malicious code can be executed by any contracts <em>it</em> calls. One particular danger is malicious code may hijack the control flow, leading to race conditions. (See <a href="https://github.com/ConsenSys/smart-contract-best-practices/#race-conditions">Race Conditions</a> for a fuller discussion of this problem).</p>
<h4 id="favor-pull-over-push-for-external-calls">Favor <em>pull</em> over <em>push</em> for external calls<a class="headerlink" href="#favor-pull-over-push-for-external-calls" title="Permanent link">&para;</a></h4>
<p>As we've seen, external calls can fail for a number of reasons, including external errors. To minimize the damage caused by such failures, it is often better to isolate each external call into its own transaction that can be initiated by the recipient of the call. This is especially relevant for payments, where it is better to let users withdraw funds rather than push funds to them automatically. (This also reduces the chance of <a href="https://github.com/ConsenSys/smart-contract-best-practices/#dos-with-block-gas-limit">problems with the gas limit</a>.)</p>
<div class="codehilite"><pre><span></span>// bad
contract auction {
    address highestBidder;
    uint highestBid;

    function bid() {
        if (msg.value &lt; highestBid) throw;

        if (highestBidder != 0) {
            if (!highestBidder.send(highestBid)) { // if this call consistently fails, no one else can bid
                throw;
            }
        }

       highestBidder = msg.sender;
       highestBid = msg.value;
    }
}

// good
contract auction {
    address highestBidder;
    uint highestBid;
    mapping(address =&gt; uint) refunds;

    function bid() external {
        if (msg.value &lt; highestBid) throw;

        if (highestBidder != 0) {
            refunds[highestBidder] += highestBid; // record the refund that this user can claim
        }

        highestBidder = msg.sender;
        highestBid = msg.value;
    }

    function withdrawRefund() external {
        uint refund = refunds[msg.sender];
        refunds[msg.sender] = 0;
        if (!msg.sender.send(refund)) {
            refunds[msg.sender] = refund; // reverting state because send failed
        }
    }
}
</pre></div>

<h4 id="mark-untrusted-contracts">Mark untrusted contracts<a class="headerlink" href="#mark-untrusted-contracts" title="Permanent link">&para;</a></h4>
<p>When interacting with external contracts, name your variables, methods, and contract interfaces in a way that makes it clear that interacting with them is potentially unsafe. This applies to your own functions that call external contracts.</p>
<div class="codehilite"><pre><span></span><span class="c1">// bad</span>
<span class="nx">Bank</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// Unclear whether trusted or untrusted</span>

<span class="kd">function</span> <span class="nx">makeWithdrawal</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Isn&#39;t clear that this function is potentially unsafe</span>
    <span class="nx">UntrustedBank</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">(</span><span class="nx">amount</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="nx">UntrustedBank</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// untrusted external call</span>
<span class="nx">TrustedBank</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span> <span class="c1">// external but trusted bank contract maintained by XYZ Corp</span>

<span class="kd">function</span> <span class="nx">makeUntrustedWithdrawal</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">UntrustedBank</span><span class="p">.</span><span class="nx">withdraw</span><span class="p">(</span><span class="nx">amount</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>

<h3 id="beware-rounding-with-integer-division">Beware rounding with integer division<a class="headerlink" href="#beware-rounding-with-integer-division" title="Permanent link">&para;</a></h3>
<p>All integer divison rounds down to the nearest integer. If you need more precision, consider using a multiplier, or store both the numerator and denominator.</p>
<p>(In the future, Solidity will have a fixed-point type, which will make this easier.)</p>
<div class="codehilite"><pre><span></span>// bad
uint x = 5 / 2; // Result is 2, all integer divison rounds DOWN to the nearest integer

// good
uint multiplier = 10;
uint x = (5 * multiplier) / 2;

uint numerator = 5;
uint denominator = 2;
</pre></div>

<h3 id="remember-that-on-chain-data-is-public">Remember that on-chain data is public<a class="headerlink" href="#remember-that-on-chain-data-is-public" title="Permanent link">&para;</a></h3>
<p>Many applications require submitted data to be private up until some point in time in order to work. Games (eg. on-chain rock-paper-scissors) and auction mechanisms (eg. sealed-bid second-price auctions) are two major categories of examples. If you are building an application where privacy is an issue, take care to avoid requiring users to publish information too early.</p>
<p>Examples:</p>
<ul>
<li>In rock paper scissors, require both players to submit a hash of their intended move first, then require both players to submit their move; if the submitted move does not match the hash throw it out.</li>
<li>In an auction, require players to submit a hash of their bid value in an initial phase (along with a deposit greater than their bid value), and then submit their action bid value in the second phase.</li>
<li>When developing an application that depends on a random number generator, the order should always be (1) players submit moves, (2) random number generated, (3) players paid out. The method by which random numbers are generated is itself an area of active research; current best-in-class solutions include Bitcoin block headers (verified through <a href="http://btcrelay.org">btcrelay.org</a>), hash-commit-reveal schemes (ie. one party generates a number, publishes its hash to "commit" to the value, and then reveals the value later) and <a href="http://github.com/randao/randao">RANDAO</a>.</li>
<li>If you are implementing a frequent batch auction, a hash-commit scheme is also desirable.</li>
</ul>
<h3 id="in-2-party-or-n-party-contracts-beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return">In 2-party or N-party contracts, beware of the possibility that some participants may "drop offline" and not return<a class="headerlink" href="#in-2-party-or-n-party-contracts-beware-of-the-possibility-that-some-participants-may-drop-offline-and-not-return" title="Permanent link">&para;</a></h3>
<p>Do not make refund or claim processes dependent on a specific party performing a particular action with no other way of getting the funds out. For example, in a rock-paper-scissors game, one common mistake is to not make a payout until both players submit their moves; however, a malicious player can "grief" the other by simply never submitting their move - in fact, if a player sees the other player's revealed move and determiners that they lost, they have no reason to submit their own move at all. This issue may also arise in the context of state channel settlement. When such situations are an issue, (1) provide a way of circumventing non-participating participants, perhaps through a time limit, and (2) consider adding an additional economic incentive for participants to submit information in all of the situations in which they are supposed to do so.</p>
<h3 id="keep-fallback-functions-simple">Keep fallback functions simple<a class="headerlink" href="#keep-fallback-functions-simple" title="Permanent link">&para;</a></h3>
<p><a href="http://solidity.readthedocs.io/en/latest/contracts.html#fallback-function">Fallback functions</a> are called when a contract is sent a message with no arguments (or when no function matches), and only has access to 2,300 gas when called from a <code>.send()</code>. If you wish to be able to receive Ether from a <code>.send()</code>, the most you can do in a fallback function is log an event. Use a proper function if a computation or more gas is required.</p>
<div class="codehilite"><pre><span></span><span class="c1">// bad</span>
<span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="p">}</span>

<span class="c1">// good</span>
<span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">deposit</span><span class="p">()</span> <span class="nx">external</span> <span class="p">{</span> <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span> <span class="p">}</span>

<span class="kd">function</span><span class="p">()</span> <span class="p">{</span> <span class="nx">LogDepositReceived</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">);</span> <span class="p">}</span>
</pre></div>

<h3 id="explicitly-mark-visibility-in-functions-and-state-variables">Explicitly mark visibility in functions and state variables<a class="headerlink" href="#explicitly-mark-visibility-in-functions-and-state-variables" title="Permanent link">&para;</a></h3>
<p>Explicitly label the visibility of functions and state variables. Functions can be specified as being <code>external</code>, <code>public</code>, <code>internal</code> or <code>private</code>. For state variables, <code>external</code> is not possible. Labeling the visibility explicitly will make it easier to catch incorrect assumptions about who can call the function or access the variable.</p>
<div class="codehilite"><pre><span></span><span class="c1">// bad</span>
<span class="nx">uint</span> <span class="nx">x</span><span class="p">;</span> <span class="c1">// the default is private for state variables, but it should be made explicit</span>
<span class="kd">function</span> <span class="nx">transfer() {</span> <span class="c1">// the default is public</span>
    <span class="c1">// public code</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="nx">uint</span> <span class="kr">private</span> <span class="nx">y</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">transfer</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="c1">// public code</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">internalAction</span><span class="p">()</span> <span class="nx">internal</span> <span class="p">{</span>
    <span class="c1">// internal code</span>
<span class="p">}</span>
</pre></div>

<h3 id="beware-division-by-zero">Beware division by zero<a class="headerlink" href="#beware-division-by-zero" title="Permanent link">&para;</a></h3>
<p>Currently, Solidity <a href="https://github.com/ethereum/solidity/issues/670">returns zero</a> and does not <code>throw</code> an exception when a number is divided by zero. You therefore need to check for division by zero manually.</p>
<div class="codehilite"><pre><span></span><span class="c1">// bad</span>
<span class="kd">function</span> <span class="nx">divide</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">uint</span> <span class="nx">y</span><span class="p">)</span> <span class="nx">returns</span><span class="p">(</span><span class="nx">uint</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">x</span> <span class="o">/</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// good</span>
<span class="kd">function</span> <span class="nx">divide</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">uint</span> <span class="nx">y</span><span class="p">)</span> <span class="nx">returns</span><span class="p">(</span><span class="nx">uint</span><span class="p">)</span> <span class="p">{</span>
   <span class="k">if</span> <span class="p">(</span><span class="nx">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span>

   <span class="k">return</span> <span class="nx">x</span> <span class="o">/</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<h3 id="differentiate-functions-and-events">Differentiate functions and events<a class="headerlink" href="#differentiate-functions-and-events" title="Permanent link">&para;</a></h3>
<p>Favor capitalization and a prefix in front of events (we suggest <em>Log</em>), to prevent the risk of confusion between functions and events. For functions, always start with a lowercase letter, except for the constructor.</p>
<div class="codehilite"><pre><span></span><span class="c1">// bad</span>
<span class="nx">event</span> <span class="nx">Transfer() {</span><span class="p">}</span>
<span class="kd">function</span> <span class="nx">transfer() {</span><span class="p">}</span>

<span class="c1">// good</span>
<span class="nx">event</span> <span class="nx">LogTransfer() {</span><span class="p">}</span>
<span class="kd">function</span> <span class="nx">transfer</span><span class="p">()</span> <span class="nx">external</span> <span class="p">{}</span>
</pre></div>

<h2 id="known-attacks">Known Attacks<a class="headerlink" href="#known-attacks" title="Permanent link">&para;</a></h2>
<h3 id="call-depth-attack-deprecated">Call Depth Attack <a href="https://github.com/ConsenSys/smart-contract-best-practices/blob/master/docs/known_attacks.md#call-depth-attack-deprecated">(Deprecated)</a><a class="headerlink" href="#call-depth-attack-deprecated" title="Permanent link">&para;</a></h3>
<p>With the Call Depth Attack, <em>any</em> call (even a fully trusted and correct one) can fail. This is because there is a limit on how deep the "call stack" can go. If the attacker does a bunch of recursive calls and brings the stack depth to 1023, then they can call your function and automatically cause all of its subcalls to fail (subcalls include <code>send()</code>).</p>
<p>An example based on the previous auction code:</p>
<div class="codehilite"><pre><span></span>// INSECURE
contract auction {
    mapping(address =&gt; uint) refunds;

    // [...]

    function withdrawRefund(address recipient) {
      uint refund = refunds[recipient];
      refunds[recipient] = 0;
      recipient.send(refund); // this line is vulnerable to a call depth attack
    }
}
</pre></div>

<p>The send() can fail if the call depth is too large, causing ether to not be sent. However, the rest of the function would succeed, including the previous line which set the victim's refund balance to 0. The solution is to explicitly check for errors, as discussed previously:</p>
<div class="codehilite"><pre><span></span>contract auction {
    mapping(address =&gt; uint) refunds;

    // [...]

    function withdrawRefund(address recipient) {
      uint refund = refunds[recipient];
      refunds[recipient] = 0;
      if (!recipient.send(refund)) { throw; } // the transaction will be reverted in case of call depth attack
    }
}
</pre></div>

<h3 id="race-conditions42">Race Conditions<sup><a href='#footnote-race-condition-terminology'>*</a></sup><a class="headerlink" href="#race-conditions42" title="Permanent link">&para;</a></h3>
<p>One of the major dangers of calling external contracts is that they can take over the control flow, and make changes to your data that the calling function wasn't expecting. This class of bug can take many forms, and both of the major bugs that led to the DAO's collapse were bugs of this sort.</p>
<h4 id="reentrancy">Reentrancy<a class="headerlink" href="#reentrancy" title="Permanent link">&para;</a></h4>
<p>The first version of this bug to be noticed involved functions that could be called repeatedly, before the first invocation of the function was finished. This may cause the different invocations of the function to interact in destructive ways.</p>
<div class="codehilite"><pre><span></span><span class="c1">// INSECURE</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">userBalances</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">withdrawBalance</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">)()))</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// At this point, the caller&#39;s code is executed, and can call withdrawBalance again</span>
    <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Since the user's balance is not set to 0 until the very end of the function, the second (and later) invocations will still succeed, and will withdraw the balance over and over again. A very similar bug was one of the vulnerabilities in the DAO attack.</p>
<p>In the example given, the best way to avoid the problem is to <a href="https://github.com/ConsenSys/smart-contract-best-practices#use-send-avoid-callvalue">use <code>send()</code> instead of <code>call.value()()</code></a>. This will prevent any external code from being executed.</p>
<p>However, if you can't remove the external call, the next simplest way to prevent this attack is to make sure you don't call an external function until you've done all the internal work you need to do:</p>
<div class="codehilite"><pre><span></span><span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">userBalances</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">withdrawBalance</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">];</span>
    <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">)()))</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// The user&#39;s balance is already 0, so future invocations won&#39;t withdraw anything</span>
<span class="p">}</span>
</pre></div>

<p>Note that if you had another function which called <code>withdrawBalance()</code>, it would be potentially subject to the same attack, so you must treat any function which calls an untrusted contract as itself untrusted. See below for further discussion of potential solutions.</p>
<h4 id="cross-function-race-conditions">Cross-function Race Conditions<a class="headerlink" href="#cross-function-race-conditions" title="Permanent link">&para;</a></h4>
<p>An attacker may also be able to do a similar attack using two different functions that share the same state.</p>
<div class="codehilite"><pre><span></span><span class="c1">// INSECURE</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">userBalances</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">transfer</span><span class="p">(</span><span class="nx">address</span> <span class="nx">to</span><span class="p">,</span> <span class="nx">uint</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
       <span class="nx">userBalances</span><span class="p">[</span><span class="nx">to</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">amount</span><span class="p">;</span>
       <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">-=</span> <span class="nx">amount</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">withdrawBalance</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">];</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">)()))</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// At this point, the caller&#39;s code is executed, and can call transfer()</span>
    <span class="nx">userBalances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>In this case, the attacker calls <code>transfer()</code> when their code is executed on the external call in <code>withdrawBalance</code>. Since their balance has not yet been set to 0, they are able to transfer the tokens even though they already received the withdrawal. This vulnerability was also used in the DAO attack.</p>
<p>The same solutions will work, with the same caveats. Also note that in this example, both functions were part of the same contract. However, the same bug can occur across multiple contracts, if those contracts share state.</p>
<h4 id="pitfalls-in-race-condition-solutions">Pitfalls in Race Condition Solutions<a class="headerlink" href="#pitfalls-in-race-condition-solutions" title="Permanent link">&para;</a></h4>
<p>Since race conditions can occur across multiple functions, and even multiple contracts, any solution aimed at preventing reentry will not be sufficient.</p>
<p>Instead, we have recommended finishing all internal work first, and only then calling the external function. This rule, if followed carefully, will allow you to avoid race conditions. However, you need to not only avoid calling external functions too soon, but also avoid calling functions which call external functions. For example, the following is insecure:</p>
<div class="codehilite"><pre><span></span><span class="c1">// INSECURE</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">userBalances</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="kt">bool</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">claimedBonus</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">rewardsForA</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">withdraw</span><span class="p">(</span><span class="nx">address</span> <span class="nx">recipient</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">userBalances</span><span class="p">[</span><span class="nx">recipient</span><span class="p">];</span>
    <span class="nx">rewardsForA</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">recipient</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">)()))</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">getFirstWithdrawalBonus</span><span class="p">(</span><span class="nx">address</span> <span class="nx">recipient</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">claimedBonus</span><span class="p">[</span><span class="nx">recipient</span><span class="p">])</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Each recipient should only be able to claim the bonus once</span>

    <span class="nx">rewardsForA</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="nx">withdraw</span><span class="p">(</span><span class="nx">recipient</span><span class="p">);</span> <span class="c1">// At this point, the caller will be able to execute getFirstWithdrawalBonus again.</span>
    <span class="nx">claimedBonus</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>Even though <code>getFirstWithdrawalBonus()</code> doesn't directly call an external contract, the call in <code>withdraw()</code> is enough to make it vulnerable to a race condition. you therefore need to treat <code>withdraw()</code> as if it were also untrusted.</p>
<div class="codehilite"><pre><span></span><span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">userBalances</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="kt">bool</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">claimedBonus</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">rewardsForA</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">untrustedWithdraw</span><span class="p">(</span><span class="nx">address</span> <span class="nx">recipient</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">userBalances</span><span class="p">[</span><span class="nx">recipient</span><span class="p">];</span>
    <span class="nx">rewardsForA</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="nx">recipient</span><span class="p">.</span><span class="nx">call</span><span class="p">.</span><span class="nx">value</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">)()))</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">untrustedGetFirstWithdrawalBonus</span><span class="p">(</span><span class="nx">address</span> <span class="nx">recipient</span><span class="p">)</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">claimedBonus</span><span class="p">[</span><span class="nx">recipient</span><span class="p">])</span> <span class="p">{</span> <span class="k">throw</span><span class="p">;</span> <span class="p">}</span> <span class="c1">// Each recipient should only be able to claim the bonus once</span>

    <span class="nx">claimedBonus</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">rewardsForA</span><span class="p">[</span><span class="nx">recipient</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">100</span><span class="p">;</span>
    <span class="nx">untrustedWithdraw</span><span class="p">(</span><span class="nx">recipient</span><span class="p">);</span> <span class="c1">// claimedBonus has been set to true, so reentry is impossible</span>
<span class="p">}</span>
</pre></div>

<p>In addition to the fix making reentry impossible, <a href="https://github.com/ConsenSys/smart-contract-best-practices#mark-untrusted-contracts">untrusted functions have been marked.</a> This same pattern repeats at every level: since <code>untrustedGetFirstWithdrawalBonus()</code> calls <code>untrustedWithdraw()</code>, which calls an external contract, you must also treat <code>untrustedGetFirstWithdrawalBonus()</code> as insecure.</p>
<p>Another solution often suggested is a <a href="https://en.wikipedia.org/wiki/Mutual_exclusion">mutex</a>. This allows you to "lock" some state so it can only be changed by the owner of the lock. A simple example might look like this:</p>
<div class="codehilite"><pre><span></span><span class="c1">// Note: This is a rudimentary example, and mutexes are particularly useful where there is substantial logic and/or shared state</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">balances</span><span class="p">;</span>
<span class="kt">bool</span> <span class="kr">private</span> <span class="nx">lockBalances</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">deposit</span><span class="p">()</span> <span class="kr">public</span> <span class="nx">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lockBalances</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">lockBalances</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
        <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">+=</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
        <span class="nx">lockBalances</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="k">throw</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">withdraw</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">amount</span><span class="p">)</span> <span class="kr">public</span> <span class="nx">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">lockBalances</span> <span class="o">&amp;&amp;</span> <span class="nx">amount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="nx">amount</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">lockBalances</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>

        <span class="k">if</span> <span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">amount</span><span class="p">)())</span> <span class="p">{</span> <span class="c1">// Normally insecure, but the mutex saves it</span>
          <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">-=</span> <span class="nx">amount</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="nx">lockBalances</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">throw</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>If the user tries to call <code>withdraw()</code> again before the first call finishes, the lock will prevent it from having any effect. This can be an effective pattern, but it gets tricky when you have multiple contracts that need to cooperate. The following is insecure:</p>
<div class="codehilite"><pre><span></span>// INSECURE
contract StateHolder {
    uint private n;
    address private lockHolder;

    function getLock() {
        if (lockHolder != 0) { throw; }
        lockHolder = msg.sender;
    }

    function releaseLock() {
        lockHolder = 0;
    }

    function set(uint newState) {
        if (msg.sender != lockHolder) { throw; }
        n = newState;
    }
}
</pre></div>

<p>An attacker can call <code>getLock()</code>, and then never call <code>releaseLock()</code>. If they do this, then the contract will be locked forever, and no further changes will be able to be made. If you use mutexes to protect against race conditions, you will need to carefully ensure that there are no ways for a lock to be claimed and never released. (There are other potential dangers when programming with mutexes, such as deadlocks and livelocks. You should consult the large amount of literature already written on mutexes, if you decide to go this route.)</p>
<div style='font-size: 80%; display: inline;'>* Some may object to the use of the term <i>race condition</i>, since Ethereum does not currently have true parallelism. However, there is still the fundamental feature of logically distinct processes contending for resources, and the same sorts of pitfalls and potential solutions apply.</div>

<h3 id="dos-with-unexpected-throw">DoS with (Unexpected) Throw<a class="headerlink" href="#dos-with-unexpected-throw" title="Permanent link">&para;</a></h3>
<p>Consider a simple auction contract:</p>
<div class="codehilite"><pre><span></span>// INSECURE
contract Auction {
    address currentLeader;
    uint highestBid;

    function bid() {
        if (msg.value &lt;= highestBid) { throw; }

        if (!currentLeader.send(highestBid)) { throw; } // Refund the old leader, and throw if it fails

        currentLeader = msg.sender;
        highestBid = msg.value;
    }
}
</pre></div>

<p>When it tries to refund the old leader, it throws if the refund fails. This means that a malicious bidder can become the leader, while making sure that any refunds to their address will <em>always</em> fail. In this way, they can prevent anyone else from calling the <code>bid()</code> function, and stay the leader forever. A natural solution might be to continue even if the refund fails, under the theory that it's their own fault if they can't accept the refund.</p>
<p>Another example is when a contract may iterate through an array to pay users (e.g., supporters in a crowdfunding contract). It's common to want to make sure that each payment succeeds. If not, one should throw. The issue is that if one call fails, you are reverting the whole payout system, meaning the loop will never complete. No one gets paid, because one address is forcing an error.</p>
<div class="codehilite"><pre><span></span><span class="nx">address</span><span class="p">[]</span> <span class="kr">private</span> <span class="nx">refundAddresses</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">public</span> <span class="nx">refunds</span><span class="p">;</span>

<span class="c1">// bad</span>
<span class="kd">function</span> <span class="nx">refundAll</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="nx">uint</span> <span class="nx">x</span><span class="p">;</span> <span class="nx">x</span> <span class="o">&lt;</span> <span class="nx">refundAddresses</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// arbitrary length iteration based on how many addresses participated</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">refundAddresses</span><span class="p">[</span><span class="nx">x</span><span class="p">].</span><span class="nx">send</span><span class="p">(</span><span class="nx">refunds</span><span class="p">[</span><span class="nx">refundAddresses</span><span class="p">[</span><span class="nx">x</span><span class="p">]]))</span> <span class="p">{</span>
            <span class="k">throw</span><span class="p">;</span> <span class="c1">// doubly bad, now a single failure on send will hold up all funds</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<p>Again, the recommended solution is to <a href="#favor-pull-over-push-payments">favor pull over push payments</a>.</p>
<h3 id="dos-with-block-gas-limit">DoS with Block Gas Limit<a class="headerlink" href="#dos-with-block-gas-limit" title="Permanent link">&para;</a></h3>
<p>You may have noticed another problem with the previous example: by paying out to everyone at once, you risk running into the block gas limit. Each Ethereum block can process a certain maximum amount of computation. If you try to go over that, your transaction will fail.</p>
<p>This can lead to problems even in the absence of an intentional attack. However, it's especially bad if an attacker can manipulate the amount of gas needed. In the case of the previous example, the attacker could add a bunch of addresses, each of which needs to get a very small refund. The gas cost of refunding each of the attacker's addresses could therefore end up being more than the gas limit, blocking the refund transaction from happening at all.</p>
<p>This is another reason to <a href="#favor-pull-over-push-payments">favor pull over push payments</a>.</p>
<p>If you absolutely must loop over an array of unknown size, then you should plan for it to potentially take multiple blocks, and therefore require multiple transactions. You will need to keep track of how far you've gone, and be able to resume from that point, as in the following example:</p>
<div class="codehilite"><pre><span></span><span class="nx">struct</span> <span class="nx">Payee</span> <span class="p">{</span>
    <span class="nx">address</span> <span class="nx">addr</span><span class="p">;</span>
    <span class="nx">uint256</span> <span class="nx">value</span><span class="p">;</span>
<span class="p">}</span>
<span class="nx">Payee</span> <span class="nx">payees</span><span class="p">[];</span>
<span class="nx">uint256</span> <span class="nx">nextPayeeIndex</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">payOut() {</span>
    <span class="nx">uint256</span> <span class="nx">i</span> <span class="o">=</span> <span class="nx">nextPayeeIndex</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">payees</span><span class="p">.</span><span class="nx">length</span> <span class="o">&amp;&amp;</span> <span class="nx">msg</span><span class="p">.</span><span class="nx">gas</span> <span class="o">&gt;</span> <span class="mi">200000</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">payees</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">addr</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">payees</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">value</span><span class="p">);</span>
      <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">nextPayeeIndex</span> <span class="o">=</span> <span class="nx">i</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

<p>You will need to make sure that nothing bad will happen if other transactions are processed while waiting for the next iteration of the <code>payOut()</code> function. So only use this pattern if absolutely necessary.</p>
<h3 id="timestamp-dependence">Timestamp Dependence<a class="headerlink" href="#timestamp-dependence" title="Permanent link">&para;</a></h3>
<p>The timestamp of the block can be manipulated by the miner, and so should not be used for critical components of the contract. <em>Block numbers</em> and <em>average block time</em> can be used to estimate time, but this is not future proof as block times may change (such as the changes expected during Casper).</p>
<div class="codehilite"><pre><span></span>uint startTime = SOME_START_TIME;

if (now &gt; startTime + 1 week) { // the now can be manipulated by the miner

}
</pre></div>

<h3 id="transaction-ordering-dependence-tod">Transaction-Ordering Dependence (TOD)<a class="headerlink" href="#transaction-ordering-dependence-tod" title="Permanent link">&para;</a></h3>
<p>Since a transaction is in the mempool for a short while, one can know what actions will occur, before it is included in a block. This can be troublesome for things like decentralized markets, where a transaction to buy some tokens can be seen, and a market order implemented before the other transaction gets included. Protecting against this is difficult, as it would come down to the specific contract itself. For example, in markets, it would be better to implement batch auctions (this also protects against high frequency trading concerns). Another way to use a pre-commit scheme (“I’m going to submit the details later”).</p>
<h2 id="software-engineering-techniques">Software Engineering Techniques<a class="headerlink" href="#software-engineering-techniques" title="Permanent link">&para;</a></h2>
<p>As we discussed in the <a href="#general-philosophy">General Philosophy</a> section, it is not enough to protect yourself against the known attacks. Since the cost of failure on a blockchain can be very high, you must also adapt the way you write software, to account for that risk.</p>
<p>The approach we advocate is to "prepare for failure". It is impossible to know in advance whether your code is secure. However, you can architect your contracts in a way that allows them to fail gracefully, and with minimal damage. This section presents a variety of techniques that will help you prepare for failure.</p>
<p>Note: There's always a risk when you add a new component to your system. A badly designed fail-safe could itself become a vulnerability - as can the interaction between a number of well designed fail-safes. Be thoughtful about each technique you use in your contracts, and consider carefully how they work together to create a robust system.</p>
<h3 id="upgrading-broken-contracts">Upgrading Broken Contracts<a class="headerlink" href="#upgrading-broken-contracts" title="Permanent link">&para;</a></h3>
<p>Code will need to be changed if errors are discovered or if improvements need to be made. It is no good to discover a bug, but have no way to deal with it.</p>
<p>Designing an effective upgrade system for smart contracts is an area of active research, and we won't be able to cover all of the complications in this document. However, there are two basic approaches that are most commonly used. The simpler of the two is to have a registry contract that holds the address of the latest version of the contract. A more seamless approach for contract users is to have a contract that forwards calls and data onto the latest version of the contract.</p>
<p>Whatever the technique, it's important to have modularization and good separation between components, so that code changes do not break functionality, orphan data, or require substantial costs to port. In particular, it is usually beneficial to separate complex logic from your data storage, so that you do not have to recreate all of the data in order to change the functionality.</p>
<p>It's also critical to have a secure way for parties to decide to upgrade the code. Depending on your contract, code changes may need to be approved by a single trusted party, a group of members, or a vote of the full set of stakeholders. If this process can take some time, you will want to consider if there are other ways to react more quickly in case of an attack, such as an <a href="https://github.com/ConsenSys/smart-contract-best-practices/#circuit-breakers-pause-contract-functionality">emergency stop or circuit-breaker</a>.</p>
<p><strong>Example 1: Use a registry contract to store latest version of a contract</strong></p>
<p>In this example, the calls aren't forwarded, so users should fetch the current address each time before interacting with it.</p>
<div class="codehilite"><pre><span></span>contract SomeRegister {
    address backendContract;
    address[] previousBackends;
    address owner;

    function SomeRegister() {
        owner = msg.sender;
    }

    modifier onlyOwner() {
        if (msg.sender != owner) {
            throw;
        }
        _
    }

    function changeBackend(address newBackend) public
    onlyOwner()
    returns (bool)
    {
        if(newBackend != backendContract) {
            previousBackends.push(backendContract);
            backendContract = newBackend;
            return true;
        }

        return false;
    }
}
</pre></div>

<p>There are two main disadvantages to this approach:</p>
<ol>
<li>Users must always look up the current address, and anyone who fails to do so risks using an old version of the contract</li>
<li>You will need to think carefully about how to deal with the contract data, when you replace the contract</li>
</ol>
<p>The alternate approach is to have a contract forward calls and data to the latest version of the contract:</p>
<p><strong>Example 2: <a href="http://ethereum.stackexchange.com/questions/2404/upgradeable-contracts">Use a <code>DELEGATECALL</code></a> to forward data and calls</strong></p>
<div class="codehilite"><pre><span></span>contract Relay {
    address public currentVersion;
    address public owner;

    modifier onlyOwner() {
        if (msg.sender != owner) {
            throw;
        }
        _
    }

    function Relay(address initAddr) {
        currentVersion = initAddr;
        owner = msg.sender; // this owner may be another contract with multisig, not a single contract owner
    }

    function changeContract(address newVersion) public
    onlyOwner()
    {
        currentVersion = newVersion;
    }

    function() {
        if(!currentVersion.delegatecall(msg.data)) throw;
    }
}
</pre></div>

<p>This approach avoids the previous problems, but has problems of its own. You must be extremely careful with how you store data in this contract. If your new contract has a different storage layout than the first, your data may end up corrupted. Additionally, this simple version of the pattern cannot return values from functions, only forward them, which limits its applicability. (<a href="https://github.com/ownage-ltd/ether-router">More complex implementations</a> attempt to solve this with in-line assembly code and a registry of return sizes.)</p>
<p>Regardless of your approach, it is important to have some way to upgrade your contracts, or they will become unusable when the inevitable bugs are discovered in them.</p>
<h3 id="circuit-breakers-pause-contract-functionality">Circuit Breakers (Pause contract functionality)<a class="headerlink" href="#circuit-breakers-pause-contract-functionality" title="Permanent link">&para;</a></h3>
<p>Circuit breakers stop execution if certain conditions are met, and can be useful when new errors are discovered. For example, most actions may be suspended in a contract if a bug is discovered, and the only action now active is a withdrawal. You can either give certain trusted parties the ability to trigger the circuit breaker, or else have programmatic rules that automatically trigger the certain breaker when certain conditions are met.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="kt">bool</span> <span class="kr">private</span> <span class="nx">stopped</span> <span class="o">=</span> <span class="kc">false</span><span class="p">;</span>
<span class="nx">address</span> <span class="kr">private</span> <span class="nx">owner</span><span class="p">;</span>

<span class="nx">modifier</span> <span class="nx">isAdmin() {</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span> <span class="o">!=</span> <span class="nx">owner</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">_</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">toggleContractActive</span><span class="p">()</span> <span class="nx">isAdmin</span> <span class="kr">public</span>
<span class="p">{</span>
    <span class="c1">// You can add an additional modifier that restricts stopping a contract to be based on another action, such as a vote of users</span>
    <span class="nx">stopped</span> <span class="o">=</span> <span class="o">!</span><span class="nx">stopped</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">modifier</span> <span class="nx">stopInEmergency</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">stopped</span><span class="p">)</span> <span class="nx">_</span> <span class="p">}</span>
<span class="nx">modifier</span> <span class="nx">onlyInEmergency</span> <span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="nx">stopped</span><span class="p">)</span> <span class="nx">_</span> <span class="p">}</span>

<span class="kd">function</span> <span class="nx">deposit</span><span class="p">()</span> <span class="nx">stopInEmergency</span> <span class="kr">public</span>
<span class="p">{</span>
    <span class="c1">// some code</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">withdraw</span><span class="p">()</span> <span class="nx">onlyInEmergency</span> <span class="kr">public</span>
<span class="p">{</span>
    <span class="c1">// some code</span>
<span class="p">}</span>
</pre></div>

<h3 id="speed-bumps-delay-contract-actions">Speed Bumps (Delay contract actions)<a class="headerlink" href="#speed-bumps-delay-contract-actions" title="Permanent link">&para;</a></h3>
<p>Speed bumps slow down actions, so that if malicious actions occur, there is time to recover. For example, <a href="https://github.com/slockit/DAO/">The DAO</a> required 27 days between a successful request to split the DAO and the ability to do so. This ensured the funds were kept within the contract, increasing the likelihood of recovery. In the case of the DAO, there was no effective action that could be taken during the time given by the speed bump, but in combination with our other techniques, they can be quite effective.</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="nx">struct</span> <span class="nx">RequestedWithdrawal</span> <span class="p">{</span>
    <span class="nx">uint</span> <span class="nx">amount</span><span class="p">;</span>
    <span class="nx">uint</span> <span class="nx">time</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">uint</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">balances</span><span class="p">;</span>
<span class="nx">mapping</span> <span class="p">(</span><span class="nx">address</span> <span class="o">=&gt;</span> <span class="nx">RequestedWithdrawal</span><span class="p">)</span> <span class="kr">private</span> <span class="nx">requestedWithdrawals</span><span class="p">;</span>
<span class="nx">uint</span> <span class="nx">constant</span> <span class="nx">withdrawalWaitPeriod</span> <span class="o">=</span> <span class="mi">28</span> <span class="nx">days</span><span class="p">;</span> <span class="c1">// 4 weeks</span>

<span class="kd">function</span> <span class="nx">requestWithdrawal</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">];</span>
        <span class="nx">balances</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="c1">// for simplicity, we withdraw everything;</span>
        <span class="c1">// presumably, the deposit function prevents new deposits when withdrawals are in progress</span>

        <span class="nx">requestedWithdrawals</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">]</span> <span class="o">=</span> <span class="nx">RequestedWithdrawal</span><span class="p">({</span>
            <span class="nx">amount</span>: <span class="kt">amountToWithdraw</span><span class="p">,</span>
            <span class="nx">time</span>: <span class="kt">now</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">withdraw</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">requestedWithdrawals</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">].</span><span class="nx">amount</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="o">&amp;&amp;</span> <span class="nx">now</span> <span class="o">&gt;</span> <span class="nx">requestedWithdrawals</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">].</span><span class="nx">time</span> <span class="o">+</span> <span class="nx">withdrawalWaitPeriod</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">uint</span> <span class="nx">amountToWithdraw</span> <span class="o">=</span> <span class="nx">requestedWithdrawals</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">].</span><span class="nx">amount</span><span class="p">;</span>
        <span class="nx">requestedWithdrawals</span><span class="p">[</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">].</span><span class="nx">amount</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">msg</span><span class="p">.</span><span class="nx">sender</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">amountToWithdraw</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">throw</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<h3 id="rate-limiting">Rate Limiting<a class="headerlink" href="#rate-limiting" title="Permanent link">&para;</a></h3>
<p>Rate limiting halts or requires approval for substantial changes. For example, a depositor may only be allowed to withdraw a certain amount or percentage of total deposits over a certain time period (e.g., max 100 ether over 1 day) - additional withdrawals in that time period may fail or require some sort of special approval. Or the rate limit could be at the contract level, with only a certain amount of tokens issued by the contract over a time period.</p>
<p><a href="https://gist.github.com/PeterBorah/110c331dca7d23236f80e69c83a9d58c#file-circuitbreaker-sol">Example</a></p>
<h3 id="assert-guards">Assert Guards<a class="headerlink" href="#assert-guards" title="Permanent link">&para;</a></h3>
<p>An assert guard triggers when an assertion fails - such as an invariant property changing. For example, the token to ether issuance ratio, in a token issuance contract, may be fixed. You can verify that this is the case at all times with an assertion. Assert guards should often be combined with other techniques, such as pausing the contract and allowing upgrades. (Otherwise you may end up stuck, with an assertion that is always failing.)</p>
<p>The following example reverts transactions if the ratio of ether to total number of tokens changes:</p>
<div class="codehilite"><pre><span></span>contract TokenWithInvariants {
    mapping(address =&gt; uint) public balanceOf;
    uint public totalSupply;

    modifier checkInvariants {
        _
        if (this.balance &lt; totalSupply) throw;
    }

    function deposit(uint amount) public checkInvariants {
        // intentionally vulnerable
        balanceOf[msg.sender] += amount;
        totalSupply += amount;
    }

    function transfer(address to, uint value) public checkInvariants {
        if (balanceOf[msg.sender] &gt;= value) {
            balanceOf[to] += value;
            balanceOf[msg.sender] -= value;
        }
    }

    function withdraw() public checkInvariants {
        // intentionally vulnerable
        uint balance = balanceOf[msg.sender];
        if (msg.sender.call.value(balance)()) {
            totalSupply -= balance;
            balanceOf[msg.sender] = 0;
        }
    }
}
</pre></div>

<h3 id="contract-rollout">Contract Rollout<a class="headerlink" href="#contract-rollout" title="Permanent link">&para;</a></h3>
<p>Contracts should have a substantial and prolonged testing period - before substantial money is put at risk.</p>
<p>At minimum, you should:</p>
<ul>
<li>Have a full test suite with 100% test coverage (or close to it)</li>
<li>Deploy on your own testnet</li>
<li>Deploy on the public testnet with substantial testing and bug bounties</li>
<li>Exhaustive testing should allow various players to interact with the contract at volume</li>
<li>Deploy on the mainnet in beta, with limits to the amount at risk</li>
</ul>
<h4 id="automatic-deprecation">Automatic Deprecation<a class="headerlink" href="#automatic-deprecation" title="Permanent link">&para;</a></h4>
<p>During testing, you can force an automatic deprecation by preventing any actions, after a certain time period. For example, an alpha contract may work for several weeks and then automatically shut down all actions, except for the final withdrawal.</p>
<div class="codehilite"><pre><span></span><span class="nx">modifier</span> <span class="nx">isActive() {</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">block</span><span class="p">.</span><span class="kt">number</span> <span class="o">&gt;</span> <span class="nx">SOME_BLOCK_NUMBER</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">throw</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nx">_</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">deposit</span><span class="p">()</span> <span class="kr">public</span>
<span class="nx">isActive() {</span>
    <span class="c1">// some code</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">withdraw</span><span class="p">()</span> <span class="kr">public</span> <span class="p">{</span>
    <span class="c1">// some code</span>
<span class="p">}</span>
</pre></div>

<h4 id="restrict-amount-of-ether-per-usercontract">Restrict amount of Ether per user/contract<a class="headerlink" href="#restrict-amount-of-ether-per-usercontract" title="Permanent link">&para;</a></h4>
<p>In the early stages, you can restrict the amount of Ether for any user (or for the entire contract) - reducing the risk.</p>
<h2 id="security-related-documentation-and-procedures">Security-related Documentation and Procedures<a class="headerlink" href="#security-related-documentation-and-procedures" title="Permanent link">&para;</a></h2>
<p>When launching a contract that will have substantial funds or is required to be mission critical, it is important to include proper documentation. Some documentation related to security includes:</p>
<p><strong>Status</strong></p>
<ul>
<li>Where current code is deployed</li>
<li>Current status of deployed code (including outstanding issues, performance stats, etc.)</li>
</ul>
<p><strong>Known Issues</strong></p>
<ul>
<li>Key risks with contract</li>
<li>e.g., You can lose all your money, hacker can vote for certain outcomes</li>
<li>All known bugs/limitations</li>
<li>Potential attacks and mitigants</li>
<li>Potential conflicts of interest (e.g., will be using yourself, like Slock.it did with the DAO)</li>
</ul>
<p><strong>History</strong></p>
<ul>
<li>Testing (including usage stats, discovered bugs, length of testing)</li>
<li>People who have reviewed code (and their key feedback)</li>
</ul>
<p><strong>Procedures</strong></p>
<ul>
<li>Action plan in case a bug is discovered (e.g., emergency options, public notification process, etc.)</li>
<li>Wind down process if something goes wrong (e.g., funders will get percentage of your balance before attack, from remaining funds)</li>
<li>Responsible disclosure policy (e.g., where to report bugs found, the rules of any bug bounty program)</li>
<li>Recourse in case of failure (e.g., insurance, penalty fund, no recourse)</li>
</ul>
<p><strong>Contact Information</strong></p>
<ul>
<li>Who to contact with issues</li>
<li>Names of programmers and/or other important parties</li>
<li>Chat room where questions can be asked</li>
</ul>
<h2 id="security-tools">Security Tools<a class="headerlink" href="#security-tools" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><a href="http://www.comp.nus.edu.sg/~loiluu/papers/oyente.pdf">Oyente</a> - An upcoming tool, will analyze Ethereum code to find common vulnerabilities (e.g., Transaction Order Dependence, no checking for exceptions)</p>
</li>
<li>
<p><a href="https://github.com/raineorshine/solgraph">Solgraph</a> - Generates a DOT graph that visualizes function control flow of a Solidity contract and highlights potential security vulnerabilities.</p>
</li>
<li>
<p><a href="https://github.com/weifund/solint">solint</a> - Another upcoming tool, will provide Solidity linting that helps you enforce consistent conventions and avoid errors in your Solidity smart-contracts.</p>
</li>
</ul>
<h2 id="future-improvements">Future improvements<a class="headerlink" href="#future-improvements" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><strong>Editor Security Warnings</strong>: Editors will soon alert for common security errors, not just compilation errors. Browser Solidity is getting these features soon.</p>
</li>
<li>
<p><strong>New functional languages that compile to EVM bytecode</strong>: Functional languages gives certain guarantees over procedural languages like Solidity, namely immutability within a function and strong compile time checking. This can reduce the risk of errors by providing deterministic behavior. (for more see <a href="https://plus.google.com/u/0/events/cmqejp6d43n5cqkdl3iu0582f4k">this</a>, Curry-Howard correspondence, and linear logic)</p>
</li>
</ul>
<h2 id="smart-contract-security-bibliography">Smart Contract Security Bibliography<a class="headerlink" href="#smart-contract-security-bibliography" title="Permanent link">&para;</a></h2>
<p>A lot of this document contains code, examples and insights gained from various parts already written by the community.
Here are some of them.  Feel free to add more.</p>
<h3 id="by-ethereum-core-developers">By Ethereum core developers<a class="headerlink" href="#by-ethereum-core-developers" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://chriseth.github.io/notes/talks/safe_solidity">How to Write Safe Smart Contracts</a> (Christian Reitwiessner)</li>
<li><a href="https://blog.ethereum.org/2016/06/10/smart-contract-security/">Smart Contract Security</a> (Christian Reitwiessner)</li>
<li><a href="https://blog.ethereum.org/2016/06/19/thinking-smart-contract-security/">Thinking about Smart Contract Security</a> (Vitalik Buterin)</li>
<li><a href="http://solidity.readthedocs.io">Solidity</a></li>
<li><a href="http://solidity.readthedocs.io/en/latest/security-considerations.html">Solidity Security Considerations</a></li>
</ul>
<h3 id="by-community">By Community<a class="headerlink" href="#by-community" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="http://forum.ethereum.org/discussion/1317/reentrant-contracts">forum.ethereum.org/discussion/1317/reentrant-contracts</a></li>
<li><a href="http://hackingdistributed.com/2016/06/16/scanning-live-ethereum-contracts-for-bugs/">hackingdistributed.com/2016/06/16/scanning-live-ethereum-contracts-for-bugs/</a></li>
<li><a href="http://hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/">hackingdistributed.com/2016/06/18/analysis-of-the-dao-exploit/</a></li>
<li><a href="http://hackingdistributed.com/2016/06/22/smart-contract-escape-hatches/">hackingdistributed.com/2016/06/22/smart-contract-escape-hatches/</a></li>
<li><a href="http://martin.swende.se/blog/Devcon1-and-contract-security.html">martin.swende.se/blog/Devcon1-and-contract-security.html</a></li>
<li><a href="http://publications.lib.chalmers.se/records/fulltext/234939/234939.pdf">publications.lib.chalmers.se/records/fulltext/234939/234939.pdf</a></li>
<li><a href="http://vessenes.com/deconstructing-thedao-attack-a-brief-code-tour">vessenes.com/deconstructing-thedao-attack-a-brief-code-tour</a></li>
<li><a href="http://vessenes.com/ethereum-griefing-wallets-send-w-throw-considered-harmful">vessenes.com/ethereum-griefing-wallets-send-w-throw-considered-harmful</a></li>
<li><a href="http://vessenes.com/more-ethereum-attacks-race-to-empty-is-the-real-deal">vessenes.com/more-ethereum-attacks-race-to-empty-is-the-real-deal</a></li>
<li><a href="https://blog.blockstack.org/simple-contracts-are-better-contracts-what-we-can-learn-from-the-dao-6293214bad3a">blog.blockstack.org/simple-contracts-are-better-contracts-what-we-can-learn-from-the-dao-6293214bad3a</a></li>
<li><a href="https://blog.slock.it/deja-vu-dao-smart-contracts-audit-results-d26bc088e32e">blog.slock.it/deja-vu-dao-smart-contracts-audit-results-d26bc088e32e</a></li>
<li><a href="https://github.com/Bunjin/Rouleth/blob/master/Security.md">github.com/Bunjin/Rouleth/blob/master/Security.md</a></li>
<li><a href="https://github.com/LeastAuthority/ethereum-analyses">github.com/LeastAuthority/ethereum-analyses</a></li>
<li><a href="https://medium.com/@ConsenSys/assert-guards-towards-automated-code-bounties-safe-smart-contract-coding-on-ethereum-8e74364b795c">medium.com/@ConsenSys/assert-guards-towards-automated-code-bounties-safe-smart-contract-coding-on-ethereum-8e74364b795c</a></li>
<li><a href="https://medium.com/@coriacetic/in-bits-we-trust-4e464b418f0b">medium.com/@coriacetic/in-bits-we-trust-4e464b418f0b</a></li>
<li><a href="https://medium.com/@hrishiolickel/why-smart-contracts-fail-undiscovered-bugs-and-what-we-can-do-about-them-119aa2843007">medium.com/@hrishiolickel/why-smart-contracts-fail-undiscovered-bugs-and-what-we-can-do-about-them-119aa2843007</a></li>
<li><a href="https://medium.com/@peterborah/we-need-fault-tolerant-smart-contracts-ec1b56596dbc">medium.com/@peterborah/we-need-fault-tolerant-smart-contracts-ec1b56596dbc</a></li>
<li><a href="https://pdaian.com/blog/chasing-the-dao-attackers-wake">pdaian.com/blog/chasing-the-dao-attackers-wake</a></li>
<li><a href="http://www.comp.nus.edu.sg/~loiluu/papers/oyente.pdf">www.comp.nus.edu.sg/~loiluu/papers/oyente.pdf</a></li>
</ul>
<h2 id="attribution">Attribution<a class="headerlink" href="#attribution" title="Permanent link">&para;</a></h2>
<p>This work, "Safety", is a derivative of <a href="https://github.com/ConsenSys/smart-contract-best-practices">"Smart Contract Best Practices"</a>, used under CC BY. "Safety" is licensed under CC BY by the Ethereum community.</p>
<h2 id="license">License<a class="headerlink" href="#license" title="Permanent link">&para;</a></h2>
<p>Licensed under <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0</a></p>
<p>Licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International</a></p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../../Clients/ethereumj/" title="ethereumj (Java)" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  后退
                </span>
                ethereumj (Java)
              </span>
            </div>
          </a>
        
        
          <a href="../Resources/" title="开发资源" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  前进
                </span>
                开发资源
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            版权 &copy; 2018 -  wohugb.github.io
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="http://wohugb.github.io" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/wohugb" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/wohugb" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/wohugb" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.6cdc17f0.js"></script>
      
        
        
          
          <script src="../../assets/javascripts/lunr/lunr.stemmer.support.js"></script>
          
            
              
              <script src="../../assets/javascripts/lunr/lunr.zh.js"></script>
            
          
          
        
      
      <script>app.initialize({version:"0.17.2",url:{base:"../.."}})</script>
      
    
    
      
    
  </body>
</html>